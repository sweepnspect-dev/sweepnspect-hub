<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no">
<meta name="theme-color" content="#0F2440">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="mobile-web-app-capable" content="yes">
<title>SweepNspect Hub</title>
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'><rect width='32' height='32' rx='6' fill='%23EA580C'/><text x='16' y='22' font-size='18' font-weight='bold' fill='white' text-anchor='middle' font-family='system-ui'>S</text></svg>">
<style>
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

:root {
  --navy: #0F172A;
  --navy-light: #1E293B;
  --bg: #0F172A;
  --surface: #1E293B;
  --surface-hover: #253347;
  --accent: #EA580C;
  --accent-light: rgba(234,88,12,0.15);
  --accent-container: rgba(234,88,12,0.08);
  --text: #FFFFFF;
  --text-secondary: #94A3B8;
  --text-hint: #64748B;
  --border: #334155;
  --border-light: rgba(255,255,255,0.06);
  --green: #22C55E;
  --green-bg: rgba(34,197,94,0.12);
  --green-text: #86EFAC;
  --yellow: #F59E0B;
  --yellow-bg: rgba(245,158,11,0.12);
  --yellow-text: #FCD34D;
  --red: #EF4444;
  --red-bg: rgba(239,68,68,0.12);
  --red-text: #FCA5A5;
  --radius: 12px;
  --radius-sm: 8px;
  --radius-xs: 4px;
  --shadow-sm: 0 1px 2px rgba(0,0,0,0.2);
  --shadow: 0 1px 3px rgba(0,0,0,0.3), 0 1px 2px rgba(0,0,0,0.2);
  --shadow-md: 0 4px 6px rgba(0,0,0,0.25), 0 2px 4px rgba(0,0,0,0.2);
  --shadow-lg: 0 10px 15px rgba(0,0,0,0.3), 0 4px 6px rgba(0,0,0,0.2);
  --font: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
  --transition: 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  --safe-bottom: env(safe-area-inset-bottom, 0px);
}

html { scroll-behavior: smooth; -webkit-tap-highlight-color: transparent; }

body {
  font-family: var(--font);
  background: var(--bg);
  color: var(--text);
  line-height: 1.5;
  min-height: 100vh;
  min-height: 100dvh;
  overflow-x: hidden;
  -webkit-font-smoothing: antialiased;
}

/* ═══ TOPBAR ═══ */
.topbar {
  position: sticky;
  top: 0;
  z-index: 100;
  background: var(--navy-light);
  color: #fff;
  padding: 0 20px;
  height: 56px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  border-bottom: 1px solid var(--border);
  box-shadow: 0 2px 8px rgba(0,0,0,0.3);
}

.topbar-left { display: flex; align-items: center; gap: 12px; }

.logo {
  font-weight: 700;
  font-size: 16px;
  color: #fff;
  display: flex;
  align-items: center;
  gap: 10px;
  letter-spacing: -0.3px;
}

.logo-mark {
  width: 30px;
  height: 30px;
  background: var(--accent);
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 15px;
  font-weight: 800;
  color: #fff;
}

.topbar-center {
  display: flex;
  align-items: center;
  gap: 24px;
}

.readiness-ring {
  position: relative;
  width: 38px;
  height: 38px;
}

.readiness-ring svg {
  transform: rotate(-90deg);
  width: 38px;
  height: 38px;
}

.readiness-ring .bg-ring {
  fill: none;
  stroke: rgba(255,255,255,0.15);
  stroke-width: 3;
}

.readiness-ring .fg-ring {
  fill: none;
  stroke: var(--accent);
  stroke-width: 3;
  stroke-linecap: round;
  transition: stroke-dashoffset 0.8s cubic-bezier(0.4, 0, 0.2, 1);
}

.readiness-pct {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 10px;
  font-weight: 700;
  color: #fff;
}

.readiness-label {
  font-size: 11px;
  color: rgba(255,255,255,0.6);
  font-weight: 500;
}

.level-display { display: flex; align-items: center; gap: 10px; }

.level-badge {
  font-size: 11px;
  font-weight: 700;
  color: var(--accent);
  background: rgba(234,88,12,0.15);
  padding: 3px 8px;
  border-radius: var(--radius-xs);
  letter-spacing: 0.3px;
}

.level-name {
  font-size: 13px;
  font-weight: 600;
  color: rgba(255,255,255,0.9);
}

.xp-bar-wrap { display: flex; align-items: center; gap: 8px; }

.xp-bar {
  width: 100px;
  height: 4px;
  background: rgba(255,255,255,0.12);
  border-radius: 2px;
  overflow: hidden;
}

.xp-bar-fill {
  height: 100%;
  background: var(--accent);
  border-radius: 2px;
  transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.xp-text {
  font-size: 10px;
  color: rgba(255,255,255,0.5);
  white-space: nowrap;
  font-variant-numeric: tabular-nums;
}

.topbar-right { display: flex; align-items: center; gap: 12px; }

/* ═══ NOTIFICATIONS ═══ */
.notif-wrap { position: relative; }

.notif-btn {
  position: relative;
  background: rgba(255,255,255,0.08);
  border: none;
  border-radius: var(--radius-sm);
  padding: 8px;
  cursor: pointer;
  color: rgba(255,255,255,0.7);
  transition: var(--transition);
  display: flex;
  align-items: center;
  justify-content: center;
}

.notif-btn:hover { background: rgba(255,255,255,0.14); color: #fff; }
.notif-btn svg { width: 18px; height: 18px; display: block; }

.notif-badge {
  position: absolute;
  top: -3px;
  right: -3px;
  min-width: 16px;
  height: 16px;
  background: var(--red);
  border-radius: 8px;
  font-size: 9px;
  font-weight: 700;
  display: flex;
  align-items: center;
  justify-content: center;
  color: #fff;
  padding: 0 4px;
  border: 2px solid var(--surface);
}

.notif-dropdown {
  position: absolute;
  top: calc(100% + 8px);
  right: 0;
  width: 320px;
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  box-shadow: var(--shadow-lg);
  display: none;
  overflow: hidden;
  z-index: 200;
}

.notif-dropdown.open { display: block; }

.notif-header {
  padding: 14px 16px;
  font-size: 14px;
  font-weight: 700;
  color: var(--text);
  border-bottom: 1px solid var(--border);
}

.notif-item {
  padding: 12px 16px;
  border-bottom: 1px solid var(--border-light);
  display: flex;
  gap: 10px;
  align-items: flex-start;
  transition: background var(--transition);
}

.notif-item:hover { background: var(--surface-hover); }
.notif-item:last-child { border-bottom: none; }

.notif-dot { width: 6px; height: 6px; border-radius: 50%; margin-top: 6px; flex-shrink: 0; }
.notif-dot.orange { background: var(--accent); }
.notif-dot.green { background: var(--green); }

.notif-content { flex: 1; }
.notif-text { font-size: 13px; color: var(--text); line-height: 1.4; }
.notif-time { font-size: 11px; color: var(--text-hint); margin-top: 2px; }

/* ═══ LAYOUT ═══ */
.app-body {
  display: grid;
  grid-template-columns: 1fr 300px;
  min-height: calc(100vh - 56px);
}

.content {
  padding: 20px;
  max-width: 960px;
}

.sidebar {
  background: var(--surface);
  border-left: 1px solid var(--border);
  padding: 20px;
  position: sticky;
  top: 56px;
  height: calc(100vh - 56px);
  overflow-y: auto;
}

/* ═══ STATS ROW ═══ */
.stats-row {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 12px;
  margin-bottom: 20px;
}

.stat-card {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  padding: 16px;
  box-shadow: var(--shadow-sm);
  transition: box-shadow var(--transition);
}

.stat-card:hover { box-shadow: var(--shadow); }

.stat-label {
  font-size: 11px;
  color: var(--text-hint);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  font-weight: 600;
  margin-bottom: 4px;
}

.stat-value {
  font-size: 24px;
  font-weight: 800;
  color: var(--text);
  line-height: 1.1;
  font-variant-numeric: tabular-nums;
}

.stat-value .dim { font-size: 14px; color: var(--text-hint); font-weight: 600; }
.stat-value.accent { color: var(--accent); }
.stat-value.green { color: var(--green); }
.stat-sub { font-size: 11px; color: var(--text-secondary); margin-top: 3px; }

/* ═══ SECTION ═══ */
.section-label {
  font-size: 12px;
  color: var(--text-secondary);
  text-transform: uppercase;
  letter-spacing: 1px;
  font-weight: 700;
  margin-bottom: 12px;
  padding-bottom: 8px;
  border-bottom: 1px solid var(--border);
}

/* ═══ CATEGORY CARDS ═══ */
.cat-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 12px;
}

.cat-card {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: var(--radius);
  overflow: hidden;
  transition: all var(--transition);
  cursor: pointer;
  box-shadow: var(--shadow-sm);
}

.cat-card:hover {
  box-shadow: var(--shadow-md);
  border-color: #CBD5E1;
}

.cat-card.expanded {
  border-color: var(--accent);
  box-shadow: 0 0 0 1px var(--accent), var(--shadow-md);
}

.cat-header {
  padding: 14px 16px;
  display: flex;
  align-items: center;
  gap: 12px;
}

.cat-icon {
  width: 40px;
  height: 40px;
  border-radius: 10px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 18px;
  flex-shrink: 0;
}

.cat-info { flex: 1; min-width: 0; }

.cat-name {
  font-size: 14px;
  font-weight: 700;
  color: var(--text);
  margin-bottom: 1px;
}

.cat-progress-text {
  font-size: 12px;
  color: var(--text-secondary);
}

.cat-pct {
  font-size: 20px;
  font-weight: 800;
  line-height: 1;
  font-variant-numeric: tabular-nums;
}

.cat-pct.high { color: var(--green); }
.cat-pct.mid { color: var(--yellow); }
.cat-pct.low { color: var(--red); }

.cat-bar {
  height: 3px;
  background: var(--border-light);
  margin: 0 16px;
}

.cat-bar-fill {
  height: 100%;
  border-radius: 2px;
  transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.cat-bar-fill.high { background: var(--green); }
.cat-bar-fill.mid { background: var(--yellow); }
.cat-bar-fill.low { background: var(--red); }

.cat-items {
  max-height: 0;
  overflow: hidden;
  transition: max-height 0.35s cubic-bezier(0.4, 0, 0.2, 1);
}

.cat-card.expanded .cat-items { max-height: 600px; }

.cat-items-inner {
  padding: 4px 16px 16px;
  border-top: 1px solid var(--border-light);
}

/* ═══ CHECKLIST ITEMS ═══ */
.check-item {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 10px 0;
  border-bottom: 1px solid var(--border-light);
  min-height: 44px;
  transition: background var(--transition);
  border-radius: var(--radius-xs);
}

.check-item:last-child { border-bottom: none; }

.check-box {
  width: 20px;
  height: 20px;
  border: 2px solid #475569;
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.15s;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.check-box:hover { border-color: var(--accent); }

.check-box.checked {
  background: var(--green);
  border-color: var(--green);
}

.check-box.checked::after {
  content: '';
  width: 6px;
  height: 10px;
  border: solid #fff;
  border-width: 0 2.5px 2.5px 0;
  transform: rotate(45deg) translate(-1px, -1px);
}

.check-label {
  font-size: 14px;
  color: var(--text);
  flex: 1;
  line-height: 1.3;
}

.check-item.done .check-label {
  color: var(--text-hint);
  text-decoration: line-through;
}

.check-xp {
  font-size: 11px;
  font-weight: 600;
  color: var(--accent);
  background: var(--accent-light);
  padding: 2px 8px;
  border-radius: 10px;
  white-space: nowrap;
}

.check-item.done .check-xp {
  color: var(--text-hint);
  background: rgba(255,255,255,0.04);
}

/* ═══ SIDEBAR ═══ */
.sidebar-section { margin-bottom: 24px; }

.sidebar-title {
  font-size: 12px;
  color: var(--text-secondary);
  text-transform: uppercase;
  letter-spacing: 1px;
  font-weight: 700;
  margin-bottom: 12px;
}

.up-next-item {
  padding: 12px;
  background: var(--surface-hover);
  border: 1px solid var(--border);
  border-radius: var(--radius-sm);
  margin-bottom: 8px;
  transition: all var(--transition);
  cursor: pointer;
}

.up-next-item:hover {
  border-color: var(--accent);
  box-shadow: var(--shadow-sm);
}

.up-next-tag {
  font-size: 10px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  padding: 2px 8px;
  border-radius: 10px;
  display: inline-block;
  margin-bottom: 6px;
}

.up-next-name {
  font-size: 13px;
  font-weight: 600;
  color: var(--text);
  margin-bottom: 8px;
  line-height: 1.3;
}

.up-next-btn {
  font-size: 12px;
  font-weight: 600;
  color: var(--accent);
  background: var(--accent-light);
  border: none;
  padding: 5px 14px;
  border-radius: 6px;
  cursor: pointer;
  transition: all var(--transition);
}

.up-next-btn:hover {
  background: var(--accent);
  color: #fff;
}

/* ═══ MILESTONES ═══ */
.milestone-item {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 10px 0;
  border-bottom: 1px solid var(--border-light);
}

.milestone-item:last-child { border-bottom: none; }

.milestone-dot {
  width: 10px;
  height: 10px;
  border-radius: 50%;
  flex-shrink: 0;
  border: 2px solid transparent;
}

.milestone-dot.done { background: var(--green); border-color: var(--green); }
.milestone-dot.active {
  background: var(--accent);
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(234,88,12,0.15);
  animation: pulse-dot 2s infinite;
}
.milestone-dot.pending { background: var(--border); border-color: var(--border); }

.milestone-text { font-size: 13px; color: var(--text); flex: 1; }
.milestone-text.done { color: var(--text-hint); text-decoration: line-through; }
.milestone-date { font-size: 11px; color: var(--text-hint); font-variant-numeric: tabular-nums; }

@keyframes pulse-dot {
  0%, 100% { box-shadow: 0 0 0 3px rgba(234,88,12,0.15); }
  50% { box-shadow: 0 0 0 6px rgba(234,88,12,0.08); }
}

/* ═══ SESSION STATS ═══ */
.session-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 8px;
}

.session-stat {
  text-align: center;
  padding: 12px 8px;
  background: var(--surface-hover);
  border-radius: var(--radius-sm);
}

.session-stat-value {
  font-size: 20px;
  font-weight: 800;
  line-height: 1;
  margin-bottom: 2px;
}

.session-stat-label {
  font-size: 10px;
  color: var(--text-hint);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

/* ═══ XP POPUP ═══ */
.xp-popup {
  position: fixed;
  pointer-events: none;
  font-size: 15px;
  font-weight: 800;
  color: var(--accent);
  z-index: 9999;
  opacity: 0;
  transform: translateY(0);
  transition: all 0.7s cubic-bezier(0.4, 0, 0.2, 1);
  background: var(--accent-light);
  padding: 4px 10px;
  border-radius: 8px;
  border: 1px solid rgba(234,88,12,0.2);
}

.xp-popup.show { opacity: 1; transform: translateY(-30px); }
.xp-popup.fade { opacity: 0; transform: translateY(-50px); }

/* ═══ LEVEL UP ═══ */
.level-up-overlay {
  position: fixed;
  inset: 0;
  z-index: 9998;
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.3s;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(234,88,12,0.06);
}

.level-up-overlay.show { opacity: 1; }

.level-up-toast {
  background: var(--surface);
  border: 2px solid var(--accent);
  border-radius: 16px;
  padding: 20px 32px;
  text-align: center;
  box-shadow: 0 20px 60px rgba(15,36,64,0.15);
  transform: scale(0.8);
  transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
}

.level-up-overlay.show .level-up-toast { transform: scale(1); }

.level-up-icon { font-size: 32px; margin-bottom: 4px; }
.level-up-title { font-size: 18px; font-weight: 800; color: var(--accent); }
.level-up-sub { font-size: 13px; color: var(--text-secondary); margin-top: 2px; }

/* ═══ BOTTOM NAV (mobile) ═══ */
.bottom-nav {
  display: none;
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  background: var(--navy-light);
  border-top: 1px solid var(--border);
  z-index: 100;
  padding-bottom: var(--safe-bottom);
  box-shadow: 0 -2px 12px rgba(0,0,0,0.3);
}

.bottom-nav-inner {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  height: 56px;
}

.bottom-nav-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  gap: 2px;
  background: none;
  border: none;
  cursor: pointer;
  color: var(--text-hint);
  transition: color var(--transition);
  -webkit-tap-highlight-color: transparent;
  padding: 0;
}

.bottom-nav-item.active { color: var(--accent); }
.bottom-nav-item svg { width: 22px; height: 22px; }
.bottom-nav-item span { font-size: 10px; font-weight: 600; letter-spacing: 0.2px; }

/* ═══ MOBILE VIEWS ═══ */
.mobile-view { display: none; }

/* ═══ SCROLLBAR ═══ */
::-webkit-scrollbar { width: 6px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.08); border-radius: 3px; }
::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.14); }

/* ═══ RESPONSIVE: TABLET ═══ */
@media (max-width: 960px) {
  .app-body { grid-template-columns: 1fr; }
  .sidebar {
    position: static;
    height: auto;
    border-left: none;
    border-top: 1px solid var(--border);
  }
  .topbar-center { display: none; }
}

/* ═══ RESPONSIVE: MOBILE ═══ */
@media (max-width: 640px) {
  .topbar { padding: 0 16px; height: 52px; }
  .logo { font-size: 15px; }
  .logo-mark { width: 28px; height: 28px; font-size: 13px; }

  .app-body { grid-template-columns: 1fr; padding-bottom: calc(56px + var(--safe-bottom)); }

  .content { padding: 16px; }
  .content.desktop-only { display: block; }

  .sidebar { display: none; }

  .stats-row { grid-template-columns: repeat(2, 1fr); gap: 8px; margin-bottom: 16px; }
  .stat-card { padding: 12px; }
  .stat-value { font-size: 22px; }

  .cat-grid { grid-template-columns: 1fr; gap: 8px; }

  .cat-header { padding: 14px; }
  .cat-items-inner { padding: 4px 14px 14px; }

  .check-item { min-height: 48px; }
  .check-box { width: 22px; height: 22px; }

  .bottom-nav { display: block; }

  .mobile-view {
    display: none;
    padding: 16px;
    padding-bottom: calc(72px + var(--safe-bottom));
  }

  .mobile-view.active { display: block; }

  .notif-dropdown { width: calc(100vw - 32px); right: -12px; }

  #clock { display: none; }
}
</style>
</head>
<body>

<div class="level-up-overlay" id="levelUpOverlay">
  <div class="level-up-toast">
    <div class="level-up-icon">&#127942;</div>
    <div class="level-up-title" id="levelUpTitle">Level Up!</div>
    <div class="level-up-sub" id="levelUpSub"></div>
  </div>
</div>

<!-- TOPBAR -->
<header class="topbar">
  <div class="topbar-left">
    <div class="logo">
      <div class="logo-mark">S</div>
      <span>SweepNspect Hub</span>
    </div>
  </div>

  <div class="topbar-center">
    <div style="display:flex;align-items:center;gap:10px;">
      <div class="readiness-ring" id="readinessRing">
        <svg viewBox="0 0 38 38">
          <circle class="bg-ring" cx="19" cy="19" r="16" />
          <circle class="fg-ring" id="readinessCircle" cx="19" cy="19" r="16"
            stroke-dasharray="100.53" stroke-dashoffset="100.53" />
        </svg>
        <div class="readiness-pct" id="readinessPct">0%</div>
      </div>
      <span class="readiness-label">Launch Ready</span>
    </div>

    <div class="level-display">
      <span class="level-badge" id="levelBadge">LVL 3</span>
      <span class="level-name" id="levelName">Beta Recruiter</span>
      <div class="xp-bar-wrap">
        <div class="xp-bar">
          <div class="xp-bar-fill" id="xpBarFill" style="width:0%"></div>
        </div>
        <span class="xp-text" id="xpText">0 / 0 XP</span>
      </div>
    </div>
  </div>

  <div class="topbar-right">
    <div class="notif-wrap" id="notifContainer">
      <button class="notif-btn" id="notifBtn" aria-label="Notifications">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 0 1-3.46 0"/></svg>
        <span class="notif-badge" id="notifBadge">3</span>
      </button>
      <div class="notif-dropdown" id="notifDropdown">
        <div class="notif-header">Notifications</div>
        <div class="notif-item">
          <div class="notif-dot green"></div>
          <div class="notif-content">
            <div class="notif-text">Founding 25 page pushed to production</div>
            <div class="notif-time">today</div>
          </div>
        </div>
        <div class="notif-item">
          <div class="notif-dot green"></div>
          <div class="notif-content">
            <div class="notif-text">Website updated with Founding 25 banner</div>
            <div class="notif-time">today</div>
          </div>
        </div>
        <div class="notif-item">
          <div class="notif-dot orange"></div>
          <div class="notif-content">
            <div class="notif-text">Hub dashboard created</div>
            <div class="notif-time">just now</div>
          </div>
        </div>
      </div>
    </div>
    <div style="font-size:12px;color:rgba(255,255,255,0.4);font-variant-numeric:tabular-nums;" id="clock"></div>
  </div>
</header>

<!-- MAIN CONTENT -->
<div class="app-body">
  <div class="content" id="mainContent">
    <div class="stats-row" id="statsRow"></div>
    <div class="section-label">Operations</div>
    <div class="cat-grid" id="catGrid"></div>
  </div>

  <aside class="sidebar" id="sidebarDesktop">
    <div class="sidebar-section">
      <div class="sidebar-title">Up Next</div>
      <div id="upNext"></div>
    </div>
    <div class="sidebar-section">
      <div class="sidebar-title">Milestones</div>
      <div id="milestones"></div>
    </div>
    <div class="sidebar-section">
      <div class="sidebar-title">This Session</div>
      <div class="session-grid" id="sessionGrid"></div>
    </div>
  </aside>
</div>

<!-- MOBILE: UP NEXT VIEW -->
<div class="mobile-view" id="mobileUpNext">
  <div class="sidebar-title">Up Next</div>
  <div id="upNextMobile"></div>
  <div style="margin-top:24px;">
    <div class="sidebar-title">This Session</div>
    <div class="session-grid" id="sessionGridMobile"></div>
  </div>
</div>

<!-- MOBILE: TIMELINE VIEW -->
<div class="mobile-view" id="mobileTimeline">
  <div class="sidebar-title">Milestones</div>
  <div id="milestonesMobile"></div>
  <div style="margin-top:24px;">
    <div class="sidebar-title">Overall Progress</div>
    <div id="mobileProgress"></div>
  </div>
</div>

<!-- MOBILE: STATS VIEW -->
<div class="mobile-view" id="mobileStats">
  <div class="sidebar-title">Level &amp; XP</div>
  <div id="mobileXPCard"></div>
  <div style="margin-top:24px;">
    <div class="sidebar-title">Category Breakdown</div>
    <div id="mobileCatBreakdown"></div>
  </div>
</div>

<!-- BOTTOM NAV -->
<nav class="bottom-nav">
  <div class="bottom-nav-inner">
    <button class="bottom-nav-item active" data-tab="dashboard" aria-label="Dashboard">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/></svg>
      <span>Dashboard</span>
    </button>
    <button class="bottom-nav-item" data-tab="tasks" aria-label="Tasks">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><path d="M9 11l3 3L22 4"/><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/></svg>
      <span>Up Next</span>
    </button>
    <button class="bottom-nav-item" data-tab="timeline" aria-label="Timeline">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>
      <span>Timeline</span>
    </button>
    <button class="bottom-nav-item" data-tab="stats" aria-label="Stats">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"><line x1="18" y1="20" x2="18" y2="10"/><line x1="12" y1="20" x2="12" y2="4"/><line x1="6" y1="20" x2="6" y2="14"/></svg>
      <span>Stats</span>
    </button>
  </div>
</nav>

<script>
const CATEGORIES = [
  {
    id: 'legal', name: 'Legal & Compliance', icon: '\u2696\uFE0F',
    color: '#8b5cf6', bg: 'rgba(139,92,246,0.08)',
    items: [
      { id: 'privacy', name: 'Privacy Policy', xp: 30, done: true },
      { id: 'tos', name: 'Terms of Service', xp: 30, done: true },
      { id: 'f25-agreement', name: 'Founding 25 Agreement', xp: 20, done: true },
      { id: 'appstore-compliance', name: 'App Store Compliance', xp: 20, done: true },
      { id: 'refund-policy', name: 'Refund Policy', xp: 15, done: false, priority: 5 },
    ]
  },
  {
    id: 'financial', name: 'Financial & Revenue', icon: '\uD83D\uDCB0',
    color: '#22c55e', bg: 'rgba(34,197,94,0.08)',
    items: [
      { id: 'pricing-locked', name: 'Pricing Model Locked', xp: 20, done: true },
      { id: 'stripe-account', name: 'Stripe Account Setup', xp: 25, done: true },
      { id: 'payment-live', name: 'Payment Processing Live', xp: 40, done: false, priority: 2 },
      { id: 'tax-config', name: 'Tax Configuration', xp: 15, done: false, priority: 7 },
      { id: 'bookkeeping', name: 'Bookkeeping Dashboard', xp: 20, done: true },
      { id: 'invoice-templates', name: 'Invoice Templates', xp: 15, done: false, priority: 6 },
      { id: 'bank-account', name: 'Business Bank Account', xp: 10, done: false, priority: 8 },
    ]
  },
  {
    id: 'marketing', name: 'Marketing & Outreach', icon: '\uD83D\uDCE3',
    color: '#f59e0b', bg: 'rgba(245,158,11,0.08)',
    items: [
      { id: 'brand-doc', name: 'Brand Positioning Doc', xp: 20, done: true },
      { id: 'website-live', name: 'Website Live', xp: 30, done: true },
      { id: 'f25-page', name: 'Founding 25 Page', xp: 25, done: true },
      { id: 'facebook', name: 'Facebook Page', xp: 10, done: false, priority: 3 },
      { id: 'instagram', name: 'Instagram Account', xp: 10, done: false, priority: 5 },
      { id: 'analytics', name: 'Google Analytics', xp: 15, done: false, priority: 6 },
      { id: 'email-templates', name: 'Email Templates', xp: 15, done: false, priority: 4 },
      { id: 'share-links-qr', name: 'Referral Share Links + QR', xp: 20, done: false, priority: 2 },
      { id: 'fb-groups', name: 'Facebook Groups \u2014 Chimney Communities', xp: 20, done: false, priority: 1 },
    ]
  },
  {
    id: 'distribution', name: 'Distribution & Deploy', icon: '\uD83D\uDE80',
    color: '#3b82f6', bg: 'rgba(59,130,246,0.08)',
    items: [
      { id: 'dev-account', name: 'Developer Account', xp: 20, done: true },
      { id: 'app-signing', name: 'App Signing', xp: 20, done: true },
      { id: 'store-listing', name: 'Store Listing', xp: 25, done: true },
      { id: 'screenshots', name: 'Screenshots', xp: 15, done: true },
      { id: 'closed-testing', name: 'Closed Testing Published', xp: 30, done: true },
      { id: 'privacy-url', name: 'Privacy Policy URL', xp: 10, done: true },
      { id: 'prod-track', name: 'Production Track', xp: 30, done: false, priority: 3 },
      { id: 'release-notes', name: 'Release Notes', xp: 10, done: false, priority: 4 },
    ]
  },
  {
    id: 'product', name: 'Product & Technical', icon: '\u2699\uFE0F',
    color: '#06b6d4', bg: 'rgba(6,182,212,0.08)',
    items: [
      { id: 'inspection-wf', name: 'Inspection Workflow', xp: 50, done: true },
      { id: 'pdf-reports', name: 'PDF Reports', xp: 40, done: true },
      { id: 'invoicing', name: 'Invoicing', xp: 35, done: true },
      { id: 'booking', name: 'Booking System', xp: 35, done: true },
      { id: 'expenses', name: 'Expense Tracking', xp: 25, done: true },
      { id: 'db-encrypted', name: 'Database Encrypted', xp: 30, done: true },
      { id: 'security-audit', name: 'Security Audit', xp: 35, done: true },
      { id: 'offline-first', name: 'Offline-First', xp: 30, done: true },
      { id: 'string-resources', name: 'String Resources', xp: 20, done: false, priority: 7 },
      { id: 'demo-polish', name: 'Convention Demo Polish', xp: 15, done: false, priority: 2 },
    ]
  },
  {
    id: 'support', name: 'Customer Support', icon: '\uD83D\uDEE0\uFE0F',
    color: '#ec4899', bg: 'rgba(236,72,153,0.08)',
    items: [
      { id: 'support-email', name: 'Support Email Setup', xp: 10, done: true },
      { id: 'ticket-system', name: 'Ticket System', xp: 25, done: false, priority: 5 },
      { id: 'onboarding-guide', name: 'Onboarding Guide', xp: 25, done: false, priority: 2 },
      { id: 'faq', name: 'FAQ / Knowledge Base', xp: 20, done: false, priority: 6 },
      { id: 'response-templates', name: 'Response Templates', xp: 15, done: false, priority: 7 },
      { id: 'video-tutorials', name: 'Video Tutorials', xp: 20, done: false, priority: 9 },
    ]
  },
  {
    id: 'founding', name: 'Founding 25 Program', icon: '\uD83C\uDFC6',
    color: '#ea580c', bg: 'rgba(234,88,12,0.08)',
    items: [
      { id: 'charter', name: 'Charter Written', xp: 20, done: true },
      { id: 'f25-website', name: 'Website Page Live', xp: 25, done: true },
      { id: 'selection-criteria', name: 'Selection Criteria Defined', xp: 15, done: true },
      { id: 'review-process', name: 'Application Review Process', xp: 20, done: false, priority: 1 },
      { id: 'onboarding-materials', name: 'Onboarding Materials', xp: 25, done: false, priority: 2 },
      { id: 'agreement-signed', name: 'Agreement Sent/Signed', xp: 30, done: false, priority: 3 },
    ]
  },
  {
    id: 'partnerships', name: 'Partnerships', icon: '\uD83E\uDD1D',
    color: '#14b8a6', bg: 'rgba(20,184,166,0.08)',
    items: [
      { id: 'stoner-outreach', name: 'Mark Stoner \u2014 Direct Outreach', xp: 20, done: true },
      { id: 'surefire-referral', name: 'SureFire \u2014 Referral Program', xp: 25, done: false, priority: 4 },
      { id: 'surefire-ceu', name: 'SureFire \u2014 CEU Training Content', xp: 30, done: false, priority: 5 },
      { id: 'fb-chimney', name: 'Facebook Chimney Communities', xp: 20, done: false, priority: 2 },
    ]
  },
  {
    id: 'hiring', name: 'Hiring & Growth', icon: '\uD83D\uDCC8',
    color: '#a78bfa', bg: 'rgba(167,139,250,0.08)',
    items: [
      { id: 'support-hire', name: 'Support Hire Plan', xp: 15, done: false, priority: 9 },
      { id: 'dev-hire', name: 'Developer Hire Plan', xp: 15, done: false, priority: 10 },
      { id: 'contractor-budget', name: 'Contractor Budget', xp: 10, done: false, priority: 10 },
      { id: 'role-descriptions', name: 'Role Descriptions', xp: 10, done: false, priority: 10 },
    ]
  },
];

const LEVELS = [
  { threshold: 0, name: 'Paper Pusher' },
  { threshold: 100, name: 'App Builder' },
  { threshold: 300, name: 'Beta Recruiter' },
  { threshold: 600, name: 'Convention Ready' },
  { threshold: 1000, name: 'Launch Captain' },
  { threshold: 1500, name: 'Growth Engine' },
];

const MILESTONES_DATA = [
  { text: 'App feature-complete', date: 'Feb 17', status: 'done' },
  { text: 'Play Store closed testing', date: 'Feb 17', status: 'done' },
  { text: 'Website live', date: 'Feb 17', status: 'done' },
  { text: 'Founding 25 page launched', date: 'Feb 23', status: 'done' },
  { text: 'Facebook community outreach', date: 'Feb', status: 'active' },
  { text: 'First 5 founding members selected', date: 'Mar', status: 'pending' },
  { text: 'All 25 founding members confirmed', date: 'Q2', status: 'pending' },
  { text: 'Public launch', date: 'Q2', status: 'pending' },
];

let state = loadState();
let sessionDone = 0;
let sessionXP = 0;

function loadState() {
  try {
    const s = JSON.parse(localStorage.getItem('hub-state'));
    if (s && s.items) return s;
  } catch(e) {}
  const items = {};
  CATEGORIES.forEach(cat => cat.items.forEach(item => { items[item.id] = { done: item.done }; }));
  return { items, xp: calcXP(items) };
}

function saveState() { localStorage.setItem('hub-state', JSON.stringify(state)); }

function calcXP(items) {
  let xp = 0;
  CATEGORIES.forEach(cat => cat.items.forEach(item => {
    if (items[item.id] && items[item.id].done) xp += item.xp;
  }));
  return xp;
}

function getLevel(xp) {
  for (let i = LEVELS.length - 1; i >= 0; i--) { if (xp >= LEVELS[i].threshold) return i; }
  return 0;
}

function getCatStats(cat) {
  let done = 0;
  cat.items.forEach(item => { if (state.items[item.id] && state.items[item.id].done) done++; });
  return { done, total: cat.items.length, pct: Math.round((done / cat.items.length) * 100) };
}

function getAllStats() {
  let done = 0, total = 0;
  CATEGORIES.forEach(cat => { const s = getCatStats(cat); done += s.done; total += s.total; });
  return { done, total, pct: Math.round((done / total) * 100) };
}

function pctClass(pct) { return pct >= 75 ? 'high' : pct >= 25 ? 'mid' : 'low'; }

// ─── RENDER ───
function renderStats() {
  const all = getAllStats();
  const catsDone = CATEGORIES.filter(c => getCatStats(c).pct === 100).length;
  document.getElementById('statsRow').innerHTML = `
    <div class="stat-card">
      <div class="stat-label">Tasks Complete</div>
      <div class="stat-value accent">${all.done}<span class="dim">/${all.total}</span></div>
      <div class="stat-sub">${all.pct}% overall</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">Categories Clear</div>
      <div class="stat-value green">${catsDone}<span class="dim">/${CATEGORIES.length}</span></div>
      <div class="stat-sub">${CATEGORIES.length - catsDone} remaining</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">Total XP</div>
      <div class="stat-value accent">${state.xp}</div>
      <div class="stat-sub">Level ${getLevel(state.xp) + 1}</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">Next Milestone</div>
      <div class="stat-value" style="color:var(--yellow);">FB</div>
      <div class="stat-sub">Community outreach</div>
    </div>
  `;
}

function renderCategories() {
  const grid = document.getElementById('catGrid');
  grid.innerHTML = '';
  CATEGORIES.forEach(cat => {
    const stats = getCatStats(cat);
    const cls = pctClass(stats.pct);
    const card = document.createElement('div');
    card.className = 'cat-card';
    card.dataset.catId = cat.id;
    card.innerHTML = `
      <div class="cat-header">
        <div class="cat-icon" style="background:${cat.bg}">${cat.icon}</div>
        <div class="cat-info">
          <div class="cat-name">${cat.name}</div>
          <div class="cat-progress-text">${stats.done} of ${stats.total} complete</div>
        </div>
        <div class="cat-pct ${cls}">${stats.pct}%</div>
      </div>
      <div class="cat-bar"><div class="cat-bar-fill ${cls}" style="width:${stats.pct}%"></div></div>
      <div class="cat-items">
        <div class="cat-items-inner">
          ${cat.items.map(item => {
            const done = state.items[item.id] && state.items[item.id].done;
            return `<div class="check-item ${done ? 'done' : ''}" data-item-id="${item.id}">
              <div class="check-box ${done ? 'checked' : ''}" data-item-id="${item.id}"></div>
              <span class="check-label">${item.name}</span>
              <span class="check-xp">+${item.xp} XP</span>
            </div>`;
          }).join('')}
        </div>
      </div>
    `;
    card.querySelector('.cat-header').addEventListener('click', () => card.classList.toggle('expanded'));
    card.querySelectorAll('.check-box').forEach(cb => {
      cb.addEventListener('click', e => { e.stopPropagation(); toggleItem(cb.dataset.itemId, cb); });
    });
    grid.appendChild(card);
  });
}

function renderMilestones() {
  const html = MILESTONES_DATA.map(m => `
    <div class="milestone-item">
      <div class="milestone-dot ${m.status}"></div>
      <div class="milestone-text ${m.status === 'done' ? 'done' : ''}">${m.text}</div>
      <div class="milestone-date">${m.date}</div>
    </div>
  `).join('');
  document.getElementById('milestones').innerHTML = html;
  const mob = document.getElementById('milestonesMobile');
  if (mob) mob.innerHTML = html;
}

function renderUpNext() {
  const unchecked = [];
  CATEGORIES.forEach(cat => {
    cat.items.forEach(item => {
      if (!(state.items[item.id] && state.items[item.id].done) && item.priority) {
        unchecked.push({ ...item, catName: cat.name, catColor: cat.color });
      }
    });
  });
  unchecked.sort((a, b) => (a.priority || 99) - (b.priority || 99));
  const top5 = unchecked.slice(0, 5);
  const html = top5.map(item => `
    <div class="up-next-item" data-item-id="${item.id}">
      <div class="up-next-tag" style="color:${item.catColor};background:${item.catColor}12;">${item.catName}</div>
      <div class="up-next-name">${item.name}</div>
      <button class="up-next-btn" onclick="focusItem('${item.id}')">Focus</button>
    </div>
  `).join('');
  document.getElementById('upNext').innerHTML = html;
  const mob = document.getElementById('upNextMobile');
  if (mob) mob.innerHTML = html;
}

function renderTopBar() {
  const all = getAllStats();
  const circumference = 2 * Math.PI * 16;
  const offset = circumference - (all.pct / 100) * circumference;
  document.getElementById('readinessCircle').style.strokeDashoffset = offset;
  document.getElementById('readinessPct').textContent = all.pct + '%';

  const lvl = getLevel(state.xp);
  const nextLvl = lvl < LEVELS.length - 1 ? LEVELS[lvl + 1].threshold : LEVELS[lvl].threshold;
  const currThreshold = LEVELS[lvl].threshold;
  const progress = nextLvl > currThreshold ? ((state.xp - currThreshold) / (nextLvl - currThreshold)) * 100 : 100;

  document.getElementById('levelBadge').textContent = 'LVL ' + (lvl + 1);
  document.getElementById('levelName').textContent = LEVELS[lvl].name;
  document.getElementById('xpBarFill').style.width = progress + '%';
  document.getElementById('xpText').textContent = state.xp + ' / ' + nextLvl + ' XP';
}

function renderSession() {
  const html = `
    <div class="session-stat">
      <div class="session-stat-value" style="color:var(--green);">${sessionDone}</div>
      <div class="session-stat-label">Done</div>
    </div>
    <div class="session-stat">
      <div class="session-stat-value" style="color:var(--accent);">${sessionXP}</div>
      <div class="session-stat-label">XP</div>
    </div>
    <div class="session-stat">
      <div class="session-stat-value" style="color:var(--yellow);">${streak}</div>
      <div class="session-stat-label">Streak</div>
    </div>
  `;
  document.getElementById('sessionGrid').innerHTML = html;
  const mob = document.getElementById('sessionGridMobile');
  if (mob) mob.innerHTML = html;
}

function renderMobileStats() {
  const lvl = getLevel(state.xp);
  const nextLvl = lvl < LEVELS.length - 1 ? LEVELS[lvl + 1].threshold : LEVELS[lvl].threshold;
  const currThreshold = LEVELS[lvl].threshold;
  const progress = nextLvl > currThreshold ? ((state.xp - currThreshold) / (nextLvl - currThreshold)) * 100 : 100;

  document.getElementById('mobileXPCard').innerHTML = `
    <div style="background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);padding:20px;box-shadow:var(--shadow-sm);">
      <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;">
        <div>
          <div style="font-size:12px;color:var(--text-hint);font-weight:600;text-transform:uppercase;letter-spacing:0.5px;">Level ${lvl + 1}</div>
          <div style="font-size:22px;font-weight:800;color:var(--accent);">${LEVELS[lvl].name}</div>
        </div>
        <div style="font-size:28px;font-weight:800;color:var(--text);">${state.xp} <span style="font-size:14px;color:var(--text-hint);">XP</span></div>
      </div>
      <div style="height:8px;background:var(--border-light);border-radius:4px;overflow:hidden;">
        <div style="height:100%;background:var(--accent);border-radius:4px;width:${progress}%;transition:width 0.6s;"></div>
      </div>
      <div style="font-size:11px;color:var(--text-hint);margin-top:6px;text-align:right;">${state.xp} / ${nextLvl} XP to ${lvl < LEVELS.length - 1 ? LEVELS[lvl + 1].name : 'max'}</div>
    </div>
  `;

  document.getElementById('mobileCatBreakdown').innerHTML = CATEGORIES.map(cat => {
    const s = getCatStats(cat);
    const cls = pctClass(s.pct);
    const barColor = cls === 'high' ? 'var(--green)' : cls === 'mid' ? 'var(--yellow)' : 'var(--red)';
    return `
      <div style="display:flex;align-items:center;gap:12px;padding:12px 0;border-bottom:1px solid var(--border-light);">
        <div style="width:32px;height:32px;border-radius:8px;background:${cat.bg};display:flex;align-items:center;justify-content:center;font-size:15px;">${cat.icon}</div>
        <div style="flex:1;min-width:0;">
          <div style="font-size:13px;font-weight:600;color:var(--text);margin-bottom:4px;">${cat.name}</div>
          <div style="height:4px;background:var(--border-light);border-radius:2px;overflow:hidden;">
            <div style="height:100%;background:${barColor};width:${s.pct}%;border-radius:2px;"></div>
          </div>
        </div>
        <div style="font-size:13px;font-weight:700;color:${barColor};min-width:36px;text-align:right;">${s.pct}%</div>
      </div>
    `;
  }).join('');

  const mp = document.getElementById('mobileProgress');
  if (mp) {
    const all = getAllStats();
    mp.innerHTML = `
      <div style="background:var(--surface);border:1px solid var(--border);border-radius:var(--radius);padding:20px;text-align:center;box-shadow:var(--shadow-sm);">
        <div style="font-size:48px;font-weight:800;color:var(--accent);">${all.pct}%</div>
        <div style="font-size:13px;color:var(--text-secondary);margin-top:4px;">Launch Ready</div>
        <div style="font-size:12px;color:var(--text-hint);margin-top:2px;">${all.done} of ${all.total} tasks complete</div>
      </div>
    `;
  }
}

// ─── INTERACTIONS ───
function toggleItem(itemId, checkboxEl) {
  const wasDone = state.items[itemId] && state.items[itemId].done;
  state.items[itemId] = { done: !wasDone };
  state.xp = calcXP(state.items);

  if (!wasDone) {
    let xpVal = 0;
    CATEGORIES.forEach(cat => cat.items.forEach(item => { if (item.id === itemId) xpVal = item.xp; }));
    sessionDone++;
    sessionXP += xpVal;
    showXPPopup(checkboxEl, xpVal);
    const oldLvl = getLevel(state.xp - xpVal);
    const newLvl = getLevel(state.xp);
    if (newLvl > oldLvl) showLevelUp(newLvl);
  } else {
    let xpVal = 0;
    CATEGORIES.forEach(cat => cat.items.forEach(item => { if (item.id === itemId) xpVal = item.xp; }));
    sessionDone = Math.max(0, sessionDone - 1);
    sessionXP = Math.max(0, sessionXP - xpVal);
  }

  saveState();
  renderAll();
}

function showXPPopup(el, xp) {
  const rect = el.getBoundingClientRect();
  const popup = document.createElement('div');
  popup.className = 'xp-popup';
  popup.textContent = '+' + xp + ' XP';
  popup.style.left = (rect.left + rect.width / 2 - 20) + 'px';
  popup.style.top = rect.top + 'px';
  document.body.appendChild(popup);
  requestAnimationFrame(() => {
    popup.classList.add('show');
    setTimeout(() => { popup.classList.add('fade'); setTimeout(() => popup.remove(), 400); }, 600);
  });
}

function showLevelUp(newLvl) {
  const overlay = document.getElementById('levelUpOverlay');
  document.getElementById('levelUpTitle').textContent = 'Level ' + (newLvl + 1) + '!';
  document.getElementById('levelUpSub').textContent = LEVELS[newLvl].name;
  overlay.classList.add('show');
  setTimeout(() => overlay.classList.remove('show'), 2000);
}

function focusItem(itemId) {
  // Switch to dashboard on mobile
  if (window.innerWidth <= 640) switchTab('dashboard');

  setTimeout(() => {
    CATEGORIES.forEach(cat => {
      cat.items.forEach(item => {
        if (item.id === itemId) {
          const card = document.querySelector(`.cat-card[data-cat-id="${cat.id}"]`);
          if (card) {
            card.classList.add('expanded');
            const checkItem = card.querySelector(`.check-item[data-item-id="${itemId}"]`);
            if (checkItem) {
              setTimeout(() => {
                checkItem.scrollIntoView({ behavior: 'smooth', block: 'center' });
                checkItem.style.background = 'var(--accent-container)';
                checkItem.style.borderRadius = '6px';
                checkItem.style.transition = 'background 0.3s';
                setTimeout(() => { checkItem.style.background = ''; }, 2000);
              }, 350);
            }
          }
        }
      });
    });
  }, 100);
}

function renderAll() {
  renderStats();
  renderCategories();
  renderUpNext();
  renderTopBar();
  renderSession();
  renderMilestones();
  renderMobileStats();
}

// ─── BOTTOM NAV ───
function switchTab(tab) {
  document.querySelectorAll('.bottom-nav-item').forEach(b => b.classList.toggle('active', b.dataset.tab === tab));

  const mainContent = document.getElementById('mainContent');
  const views = { tasks: 'mobileUpNext', timeline: 'mobileTimeline', stats: 'mobileStats' };

  if (tab === 'dashboard') {
    mainContent.style.display = '';
    Object.values(views).forEach(id => document.getElementById(id).classList.remove('active'));
  } else {
    mainContent.style.display = 'none';
    Object.entries(views).forEach(([key, id]) => {
      document.getElementById(id).classList.toggle('active', key === tab);
    });
  }
}

document.querySelectorAll('.bottom-nav-item').forEach(btn => {
  btn.addEventListener('click', () => switchTab(btn.dataset.tab));
});

// ─── CLOCK ───
function updateClock() {
  const el = document.getElementById('clock');
  if (!el) return;
  const now = new Date();
  el.textContent = now.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }) + ' ' +
    now.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', hour12: false });
}

// ─── NOTIFICATIONS ───
document.getElementById('notifBtn').addEventListener('click', e => {
  e.stopPropagation();
  document.getElementById('notifDropdown').classList.toggle('open');
});
document.addEventListener('click', () => document.getElementById('notifDropdown').classList.remove('open'));

// ─── STREAK ───
const today = new Date().toDateString();
const lastVisit = localStorage.getItem('hub-last-visit');
let streak = parseInt(localStorage.getItem('hub-streak') || '0');
if (lastVisit !== today) {
  const yesterday = new Date(Date.now() - 86400000).toDateString();
  streak = lastVisit === yesterday ? streak + 1 : 1;
  localStorage.setItem('hub-streak', streak);
  localStorage.setItem('hub-last-visit', today);
}

// ─── INIT ───
renderAll();
updateClock();
setInterval(updateClock, 30000);
</script>
</body>
</html>
